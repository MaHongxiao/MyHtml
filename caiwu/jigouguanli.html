<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ„é‡‘æœºæ„ç®¡ç† - èµ„é‡‘é¢„ç®—ç®¡ç†ç³»ç»Ÿ</title>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        [x-cloak] { display: none !important; }
        body { 
            font-family: 'Inter', 'PingFang SC', 'Microsoft YaHei', system-ui, sans-serif; 
            background-color: #f8fafc; 
            color: #334155; 
        }
        .text-num { font-family: 'JetBrains Mono', 'Menlo', monospace; font-weight: 600; }
        .text-min { font-size: 13px; line-height: 1.5; }
        
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
            cursor: pointer;
        }
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.08); }
        .stat-card.active { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        
        .data-table th {
            background: #f8fafc;
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
            white-space: nowrap;
        }
        .data-table td {
            padding: 14px 16px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 14px;
            vertical-align: middle;
            transition: all 0.15s;
        }
        .data-table tr:hover td { background: #f8fafc; }
        
        .smart-input {
            width: 100%;
            border: 1px solid #e2e8f0;
            background: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            outline: none;
            transition: all 0.2s;
            font-size: 14px;
        }
        .smart-input:hover { border-color: #94a3b8; }
        .smart-input:focus { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        .smart-input:disabled { background-color: #f8fafc; cursor: not-allowed; color: #64748b; }
        
        .status-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }
        .status-enabled { background: #d1fae5; color: #065f46; border: 1px solid #6ee7b7; }
        .status-disabled { background: #f1f5f9; color: #64748b; border: 1px solid #e2e8f0; }
        
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.5);
            backdrop-filter: blur(4px);
            z-index: 40;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        .modal-backdrop.open { opacity: 1; visibility: visible; }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .btn-primary:hover { background: #2563eb; }
        
        .btn-secondary {
            background: white;
            color: #475569;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .btn-secondary:hover { background: #f8fafc; border-color: #cbd5e1; }
        
        .btn-success {
            background: #059669;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        .btn-success:hover { background: #047857; }
        
        .btn-danger {
            background: #dc2626;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        .btn-danger:hover { background: #b91c1c; }
        
        .action-link {
            color: #3b82f6;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            padding: 4px 8px;
            border-radius: 4px;
            white-space: nowrap;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        .action-link:hover {
            color: #2563eb;
            background: #eff6ff;
            text-decoration: underline;
        }
        .action-link.danger { color: #dc2626; }
        .action-link.danger:hover { color: #b91c1c; background: #fee2e2; }
        .action-link.success { color: #059669; }
        .action-link.success:hover { color: #047857; background: #d1fae5; }
        
        .pagination-btn {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            background: white;
            color: #475569;
            font-size: 13px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .pagination-btn:hover:not(:disabled) { border-color: #3b82f6; color: #3b82f6; }
        .pagination-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }
        .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .toast {
            position: fixed;
            top: 24px;
            right: 24px;
            background: white;
            padding: 16px 20px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            border-left: 4px solid;
            z-index: 100;
            transform: translateX(120%);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        .toast.show { transform: translateX(0); }
        .toast.success { border-color: #10b981; }
        .toast.error { border-color: #ef4444; }
        .toast.warning { border-color: #f59e0b; }
        
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
            background: #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
            display: inline-block;
        }
        .toggle-switch.enabled { background: #10b981; }
        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .toggle-switch.enabled::after { transform: translateX(20px); }
        
        .info-alert {
            background: linear-gradient(to right, #eff6ff, #ffffff);
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #1e40af;
            font-size: 14px;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden" x-data="orgManageApp()">

    <!-- é¡¶éƒ¨Header -->
    <header class="bg-white border-b border-slate-200 h-16 px-6 flex justify-between items-center shadow-sm z-30 flex-shrink-0">
        <div class="flex items-center gap-4">
            <div class="w-10 h-10 bg-gradient-to-br from-indigo-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-lg shadow-indigo-200">
                <i class="fa-solid fa-sitemap text-white text-lg"></i>
            </div>
            <div>
                <h1 class="text-lg font-bold text-slate-800">èµ„é‡‘æœºæ„ç®¡ç†</h1>
                <div class="text-xs text-slate-500 mt-0.5">ç®¡ç†æœºæ„å¯ç”¨çŠ¶æ€ï¼Œæ§åˆ¶èµ„é‡‘è®¡åˆ’å½•å…¥æƒé™</div>
            </div>
        </div>
        
        <div class="flex items-center gap-3">
            <button @click="refreshData()" class="btn-secondary">
                <i class="fa-solid fa-rotate-right" :class="loading ? 'animate-spin' : ''"></i> åˆ·æ–°
            </button>
        </div>
    </header>

    <!-- Dashboard ç»Ÿè®¡åŒº -->
    <div class="bg-white border-b border-slate-200 px-6 py-5 grid grid-cols-2 md:grid-cols-4 gap-4 flex-shrink-0">
        <div class="stat-card flex items-center justify-between" :class="{'active': currentTab === 'all'}" @click="currentTab = 'all'">
            <div>
                <div class="text-xs text-slate-500 mb-1 font-medium">å…¨éƒ¨æœºæ„</div>
                <div class="text-2xl font-bold text-slate-800" x-text="stats.total">0</div>
            </div>
            <div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center text-slate-600">
                <i class="fa-solid fa-building text-xl"></i>
            </div>
        </div>
        
        <div class="stat-card flex items-center justify-between" :class="{'active': currentTab === 'enabled'}" @click="currentTab = 'enabled'">
            <div>
                <div class="text-xs text-slate-500 mb-1 font-medium">å·²å¯ç”¨</div>
                <div class="text-2xl font-bold text-emerald-600" x-text="stats.enabled">0</div>
            </div>
            <div class="w-12 h-12 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600">
                <i class="fa-solid fa-check-circle text-xl"></i>
            </div>
        </div>
        
        <div class="stat-card flex items-center justify-between" :class="{'active': currentTab === 'disabled'}" @click="currentTab = 'disabled'">
            <div>
                <div class="text-xs text-slate-500 mb-1 font-medium">å·²åœç”¨</div>
                <div class="text-2xl font-bold text-slate-600" x-text="stats.disabled">0</div>
            </div>
            <div class="w-12 h-12 rounded-full bg-slate-200 flex items-center justify-center text-slate-500">
                <i class="fa-solid fa-ban text-xl"></i>
            </div>
        </div>
        
        <div class="stat-card flex items-center justify-between border-blue-200 bg-blue-50">
            <div>
                <div class="text-xs text-blue-600 mb-1 font-medium">ä»Šæ—¥å˜æ›´</div>
                <div class="text-2xl font-bold text-blue-700" x-text="stats.todayChanged">0</div>
            </div>
            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                <i class="fa-solid fa-clock-rotate-left text-xl"></i>
            </div>
        </div>
    </div>

    <!-- ä¸»ä½“å†…å®¹åŒº -->
    <main class="flex-1 overflow-hidden flex flex-col bg-slate-50">
        
        <!-- ç³»ç»Ÿæç¤º -->
        <div class="mx-6 mt-4 info-alert">
            <i class="fa-solid fa-circle-info text-blue-500 text-lg"></i>
            <div>
                <div class="font-medium text-blue-900">ç³»ç»Ÿæç¤º</div>
                <div class="text-sm text-blue-700 mt-0.5">æœºæ„æ•°æ®ç”±ç”¨æˆ·ä¸­å¿ƒç³»ç»Ÿè‡ªåŠ¨åŒæ­¥ç”Ÿæˆï¼Œä»…æ”¯æŒå¯ç”¨/åœç”¨æ“ä½œï¼Œæ— æ³•æ‰‹åŠ¨æ–°å¢æˆ–ä¿®æ”¹æœºæ„ä¿¡æ¯ã€‚</div>
            </div>
        </div>
        
        <!-- é«˜çº§ç­›é€‰æ  -->
        <div class="bg-white border-b border-slate-200 p-4 flex flex-wrap gap-3 items-end shadow-sm mx-6 mt-4 rounded-t-xl border-x border-t">
            <div class="flex-1 min-w-[200px]">
                <label class="block text-xs text-slate-500 mb-1.5 font-medium">æœºæ„åç§°</label>
                <div class="relative">
                    <i class="fa-solid fa-search absolute left-3 top-2.5 text-slate-400 text-sm"></i>
                    <input type="text" x-model="filters.orgName" placeholder="æœç´¢æœºæ„åç§°..." class="smart-input pl-9">
                </div>
            </div>
            
            <div class="flex-1 min-w-[200px]">
                <label class="block text-xs text-slate-500 mb-1.5 font-medium">éƒ¨é—¨åç§°</label>
                <div class="relative">
                    <i class="fa-solid fa-search absolute left-3 top-2.5 text-slate-400 text-sm"></i>
                    <input type="text" x-model="filters.deptName" placeholder="æœç´¢éƒ¨é—¨åç§°..." class="smart-input pl-9">
                </div>
            </div>
            
            <div class="w-32">
                <label class="block text-xs text-slate-500 mb-1.5 font-medium">å¯ç”¨çŠ¶æ€</label>
                <select x-model="filters.status" class="smart-input">
                    <option value="">å…¨éƒ¨</option>
                    <option value="enabled">å·²å¯ç”¨</option>
                    <option value="disabled">å·²åœç”¨</option>
                </select>
            </div>
            
            <div class="w-40">
                <label class="block text-xs text-slate-500 mb-1.5 font-medium">åˆ›å»ºæ—¥æœŸ</label>
                <input type="date" x-model="filters.createDate" class="smart-input">
            </div>
            
            <button @click="resetFilters()" class="btn-secondary mb-0.5 h-10">
                <i class="fa-solid fa-rotate-left mr-1"></i> é‡ç½®
            </button>
        </div>

        <!-- æ‰¹é‡æ“ä½œæ  -->
        <div x-show="selectedIds.length > 0" class="mx-6 bg-indigo-50 border-x border-indigo-200 p-3 flex items-center justify-between fade-in">
            <div class="flex items-center gap-3">
                <span class="text-sm font-medium text-indigo-900">
                    å·²é€‰æ‹© <span x-text="selectedIds.length" class="font-bold"></span> ä¸ªæœºæ„
                </span>
                <span class="text-slate-300">|</span>
                <button @click="batchEnable()" class="text-sm text-emerald-700 hover:text-emerald-800 font-medium px-2 py-1 rounded hover:bg-emerald-100 transition flex items-center gap-1">
                    <i class="fa-solid fa-check"></i> æ‰¹é‡å¯ç”¨
                </button>
                <button @click="batchDisable()" class="text-sm text-slate-700 hover:text-slate-800 font-medium px-2 py-1 rounded hover:bg-slate-200 transition flex items-center gap-1">
                    <i class="fa-solid fa-ban"></i> æ‰¹é‡åœç”¨
                </button>
            </div>
            <button @click="selectedIds = []" class="text-sm text-slate-500 hover:text-slate-700">
                å–æ¶ˆé€‰æ‹©
            </button>
        </div>

        <!-- æ•°æ®è¡¨æ ¼ -->
        <div class="flex-1 bg-white overflow-hidden flex flex-col mx-6 mb-6 rounded-b-xl border border-slate-200 shadow-sm">
            <div class="overflow-auto custom-scroll flex-1">
                <table class="w-full data-table">
                    <thead class="sticky top-0 z-10">
                        <tr>
                            <th class="w-10 text-center">
                                <input type="checkbox" :checked="isAllSelected" @change="toggleSelectAll()" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500">
                            </th>
                            <th class="w-16 text-center">#</th>
                            <th class="min-w-[220px]">æœºæ„åç§°</th>
                            <th class="min-w-[180px]">éƒ¨é—¨åç§°</th>
                            <th class="w-32">æ“ä½œäºº</th>
                            <th class="w-32">åˆ›å»ºæ—¥æœŸ</th>
                            <th class="w-32">å˜æ›´æ—¥æœŸ</th>
                            <th class="w-32 text-center">å¯ç”¨çŠ¶æ€</th>
                            <th class="w-32 text-center">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <template x-for="(item, index) in paginatedData" :key="item.id">
                            <tr class="fade-in">
                                <td class="text-center" @click.stop>
                                    <input type="checkbox" :value="item.id" x-model="selectedIds" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500">
                                </td>
                                <td class="text-center text-slate-400" x-text="index + 1 + (currentPage - 1) * pageSize"></td>
                                <td>
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold" x-text="item.orgName.charAt(0)"></div>
                                        <span class="font-medium text-slate-800" x-text="item.orgName"></span>
                                    </div>
                                </td>
                                <td>
                                    <span class="text-slate-700" x-text="item.deptName"></span>
                                </td>
                                <td class="text-slate-600">
                                    <div class="flex items-center gap-2">
                                        <div class="w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center text-xs text-slate-600" x-text="item.operator.charAt(0)"></div>
                                        <span x-text="item.operator"></span>
                                    </div>
                                </td>
                                <td class="text-min text-slate-500" x-text="item.createDate"></td>
                                <td class="text-min text-slate-500" x-text="item.updateDate || '-'"></td>
                                <td class="text-center">
                                    <div class="flex items-center justify-center gap-2">
                                        <span class="status-tag" :class="item.status === 'enabled' ? 'status-enabled' : 'status-disabled'">
                                            <i class="fa-solid fa-circle text-[8px]"></i>
                                            <span x-text="item.status === 'enabled' ? 'å·²å¯ç”¨' : 'å·²åœç”¨'"></span>
                                        </span>
                                    </div>
                                </td>
                                <td class="text-center">
                                    <div class="flex items-center justify-center gap-2">
                                        <template x-if="item.status === 'disabled'">
                                            <button @click="enableItem(item)" class="btn-success">
                                                <i class="fa-solid fa-check"></i> å¯ç”¨
                                            </button>
                                        </template>
                                        <template x-if="item.status === 'enabled'">
                                            <button @click="disableItem(item)" class="btn-danger">
                                                <i class="fa-solid fa-ban"></i> åœç”¨
                                            </button>
                                        </template>
                                    </div>
                                </td>
                            </tr>
                        </template>
                        
                        <!-- ç©ºçŠ¶æ€ -->
                        <tr x-show="paginatedData.length === 0">
                            <td colspan="9" class="text-center py-16 text-slate-400">
                                <div class="mb-4 text-4xl">ğŸ¢</div>
                                <div class="text-min mb-2">æš‚æ— èµ„é‡‘æœºæ„è®°å½•</div>
                                <div class="text-xs text-slate-400">æœºæ„æ•°æ®å°†ä»ç”¨æˆ·ä¸­å¿ƒè‡ªåŠ¨åŒæ­¥</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- åˆ†é¡µ -->
            <div class="border-t border-slate-200 px-6 py-4 flex items-center justify-between bg-slate-50">
                <div class="text-xs text-slate-500">
                    æ˜¾ç¤º <span x-text="filteredData.length > 0 ? (currentPage - 1) * pageSize + 1 : 0" class="font-medium"></span> - 
                    <span x-text="Math.min(currentPage * pageSize, filteredData.length)" class="font-medium"></span> æ¡ï¼Œ
                    å…± <span x-text="filteredData.length" class="font-medium"></span> æ¡
                </div>
                <div class="flex gap-2">
                    <button @click="currentPage = 1" :disabled="currentPage === 1" class="pagination-btn">
                        <i class="fa-solid fa-angles-left"></i>
                    </button>
                    <button @click="currentPage--" :disabled="currentPage === 1" class="pagination-btn">
                        <i class="fa-solid fa-angle-left"></i>
                    </button>
                    
                    <template x-for="page in displayedPages" :key="page">
                        <button @click="currentPage = page" 
                                class="pagination-btn" 
                                :class="page === currentPage ? 'active' : ''"
                                x-text="page"></button>
                    </template>
                    
                    <button @click="currentPage++" :disabled="currentPage === totalPages" class="pagination-btn">
                        <i class="fa-solid fa-angle-right"></i>
                    </button>
                    <button @click="currentPage = totalPages" :disabled="currentPage === totalPages" class="pagination-btn">
                        <i class="fa-solid fa-angles-right"></i>
                    </button>
                </div>
                <div class="flex items-center gap-2 text-xs text-slate-500">
                    <select x-model.number="pageSize" @change="currentPage = 1" class="smart-input py-1 px-2 w-16 text-center">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                    </select>
                    <span>æ¡/é¡µ</span>
                </div>
            </div>
        </div>
    </main>

    <!-- ç¡®è®¤å¼¹çª— -->
    <div x-show="confirmModal.open" class="fixed inset-0 z-[60] flex items-center justify-center modal-backdrop" x-cloak>
        <div class="bg-white w-full max-w-md rounded-xl shadow-2xl p-6 text-center fade-in">
            <div class="w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-4" :class="confirmModal.type === 'danger' ? 'bg-red-100 text-red-500' : 'bg-emerald-100 text-emerald-500'">
                <i class="fa-solid text-2xl" :class="confirmModal.icon"></i>
            </div>
            <h3 class="text-lg font-bold text-slate-800 mb-2" x-text="confirmModal.title"></h3>
            <p class="text-sm text-slate-500 mb-6" x-text="confirmModal.message"></p>
            <div class="flex justify-center gap-3">
                <button @click="confirmModal.open = false" class="px-5 py-2 border border-slate-300 rounded-lg text-slate-700 text-sm font-medium hover:bg-slate-50 transition">å–æ¶ˆ</button>
                <button @click="executeConfirm()" :class="confirmModal.type === 'danger' ? 'btn-danger' : 'btn-success'" class="px-5 py-2 rounded-lg text-sm font-medium">
                    <span x-text="confirmModal.confirmText"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast æç¤º -->
    <div class="toast" :class="[toast.type, {'show': toast.show}]">
        <div class="flex items-center gap-3">
            <i class="fa-solid text-lg" :class="{
                'fa-check-circle text-emerald-500': toast.type === 'success',
                'fa-circle-exclamation text-red-500': toast.type === 'error',
                'fa-triangle-exclamation text-amber-500': toast.type === 'warning'
            }"></i>
            <div>
                <div class="font-medium text-slate-800" x-text="toast.title"></div>
                <div class="text-xs text-slate-500 mt-0.5" x-text="toast.message" x-show="toast.message"></div>
            </div>
        </div>
    </div>

    <script>
        function orgManageApp() {
            return {
                loading: false,
                currentTab: 'all',
                currentPage: 1,
                pageSize: 10,
                selectedIds: [],
                
                filters: {
                    orgName: '',
                    deptName: '',
                    status: '',
                    createDate: ''
                },
                
                dataList: [],
                
                confirmModal: {
                    open: false,
                    type: 'danger',
                    title: '',
                    message: '',
                    confirmText: 'ç¡®è®¤',
                    icon: 'fa-exclamation',
                    onConfirm: null
                },
                
                toast: { show: false, type: 'success', title: '', message: '', timer: null },

                init() {
                    this.generateMockData();
                },

                generateMockData() {
                    const orgs = [
                        'ä¸­æ£€è®¡é‡æœ‰é™å…¬å¸',
                        'ä¸­æ£€é›†å›¢æº¯æºæŠ€æœ¯æœåŠ¡æœ‰é™å…¬å¸',
                        'ä¸­æ£€ï¼ˆæ±Ÿè‹ï¼‰è®¡é‡æµ‹è¯•æœ‰é™å…¬å¸',
                        'ä¸­æ£€ååŒ—è®¡é‡æœ‰é™å…¬å¸',
                        'ä¸­æ£€ä¸–æ ‡ï¼ˆå—é€šï¼‰è®¡é‡æ£€æµ‹æœ‰é™å…¬å¸',
                        'ä¸­æ£€ï¼ˆå¹¿ä¸œï¼‰è®¡é‡æ£€æµ‹æŠ€æœ¯æœåŠ¡æœ‰é™å…¬å¸'
                    ];
                    
                    const depts = [
                        'æœ‰æœºåˆ†æå®éªŒå®¤',
                        'æ— æœºåˆ†æå®éªŒå®¤',
                        'å¾®ç”Ÿç‰©æ£€æµ‹éƒ¨',
                        'è´¨æ§éƒ¨',
                        'ç ”å‘éƒ¨',
                        'è´¢åŠ¡éƒ¨'
                    ];
                    
                    const data = [];
                    let id = 1;
                    
                    orgs.forEach((org, idx) => {
                        depts.forEach((dept, dIdx) => {
                            const isEnabled = Math.random() > 0.3;
                            const today = new Date();
                            const createDate = new Date(today.getTime() - Math.random() * 30 * 24 * 60 * 60 * 1000);
                            
                            data.push({
                                id: id++,
                                orgName: org,
                                deptName: dept,
                                status: isEnabled ? 'enabled' : 'disabled',
                                operator: ['ç³»ç»ŸåŒæ­¥', 'å¼ è´¢åŠ¡', 'æä¼šè®¡'][Math.floor(Math.random() * 3)],
                                createDate: createDate.toISOString().split('T')[0],
                                updateDate: isEnabled ? createDate.toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
                                remark: ''
                            });
                        });
                    });
                    
                    this.dataList = data;
                },

                get stats() {
                    const today = new Date().toISOString().split('T')[0];
                    return {
                        total: this.dataList.length,
                        enabled: this.dataList.filter(d => d.status === 'enabled').length,
                        disabled: this.dataList.filter(d => d.status === 'disabled').length,
                        todayChanged: this.dataList.filter(d => d.updateDate === today).length
                    };
                },

                get filteredData() {
                    let data = this.dataList.filter(item => {
                        if (this.currentTab === 'enabled' && item.status !== 'enabled') return false;
                        if (this.currentTab === 'disabled' && item.status !== 'disabled') return false;
                        
                        if (this.filters.orgName && !item.orgName.includes(this.filters.orgName)) return false;
                        if (this.filters.deptName && !item.deptName.includes(this.filters.deptName)) return false;
                        if (this.filters.status && item.status !== this.filters.status) return false;
                        if (this.filters.createDate && item.createDate !== this.filters.createDate) return false;
                        
                        return true;
                    });
                    
                    data.sort((a, b) => new Date(b.createDate) - new Date(a.createDate));
                    return data;
                },

                get paginatedData() {
                    const start = (this.currentPage - 1) * this.pageSize;
                    return this.filteredData.slice(start, start + this.pageSize);
                },

                get totalPages() {
                    return Math.ceil(this.filteredData.length / this.pageSize) || 1;
                },

                get displayedPages() {
                    const pages = [];
                    const maxDisplay = 5;
                    let start = Math.max(1, this.currentPage - 2);
                    let end = Math.min(this.totalPages, start + maxDisplay - 1);
                    if (end - start < maxDisplay - 1) start = Math.max(1, end - maxDisplay + 1);
                    for (let i = start; i <= end; i++) pages.push(i);
                    return pages;
                },

                get isAllSelected() {
                    return this.paginatedData.length > 0 && this.paginatedData.every(item => this.selectedIds.includes(item.id));
                },

                toggleSelectAll() {
                    if (this.isAllSelected) {
                        this.selectedIds = [];
                    } else {
                        this.selectedIds = this.paginatedData.map(item => item.id);
                    }
                },

                resetFilters() {
                    this.filters = {
                        orgName: '',
                        deptName: '',
                        status: '',
                        createDate: ''
                    };
                    this.currentPage = 1;
                },

                enableItem(item) {
                    this.confirmModal = {
                        open: true,
                        type: 'success',
                        title: 'ç¡®è®¤å¯ç”¨æœºæ„ï¼Ÿ',
                        message: `å¯ç”¨åï¼Œ${item.orgName} - ${item.deptName} å°†å…è®¸è¿›è¡Œèµ„é‡‘è®¡åˆ’å½•å…¥å’Œèµ„é‡‘å˜åŠ¨æ˜ç»†å½•å…¥ã€‚`,
                        confirmText: 'ç¡®è®¤å¯ç”¨',
                        icon: 'fa-check',
                        onConfirm: () => {
                            item.status = 'enabled';
                            item.updateDate = new Date().toISOString().split('T')[0];
                            this.showToast('å¯ç”¨æˆåŠŸ', 'success', 'è¯¥æœºæ„å·²å¯ç”¨ï¼Œå¯ä»¥è¿›è¡Œèµ„é‡‘å½•å…¥');
                            this.confirmModal.open = false;
                        }
                    };
                },

                disableItem(item) {
                    this.confirmModal = {
                        open: true,
                        type: 'danger',
                        title: 'ç¡®è®¤åœç”¨æœºæ„ï¼Ÿ',
                        message: `åœç”¨åï¼Œ${item.orgName} - ${item.deptName} å°†æ— æ³•è¿›è¡Œèµ„é‡‘è®¡åˆ’å½•å…¥å’Œèµ„é‡‘å˜åŠ¨æ˜ç»†å½•å…¥ï¼Œå·²æœ‰æ•°æ®ä¸å—å½±å“ã€‚`,
                        confirmText: 'ç¡®è®¤åœç”¨',
                        icon: 'fa-ban',
                        onConfirm: () => {
                            item.status = 'disabled';
                            item.updateDate = new Date().toISOString().split('T')[0];
                            this.showToast('åœç”¨æˆåŠŸ', 'warning', 'è¯¥æœºæ„å·²åœç”¨ï¼Œç¦æ­¢èµ„é‡‘å½•å…¥');
                            this.confirmModal.open = false;
                        }
                    };
                },

                executeConfirm() {
                    if (this.confirmModal.onConfirm) {
                        this.confirmModal.onConfirm();
                    }
                },

                batchEnable() {
                    const count = this.selectedIds.length;
                    this.confirmModal = {
                        open: true,
                        type: 'success',
                        title: `ç¡®è®¤æ‰¹é‡å¯ç”¨ ${count} ä¸ªæœºæ„ï¼Ÿ`,
                        message: 'å¯ç”¨åï¼Œé€‰ä¸­çš„æœºæ„å°†å…è®¸è¿›è¡Œèµ„é‡‘è®¡åˆ’å½•å…¥ã€‚',
                        confirmText: 'ç¡®è®¤å¯ç”¨',
                        icon: 'fa-check',
                        onConfirm: () => {
                            const today = new Date().toISOString().split('T')[0];
                            this.selectedIds.forEach(id => {
                                const item = this.dataList.find(d => d.id === id);
                                if (item) {
                                    item.status = 'enabled';
                                    item.updateDate = today;
                                }
                            });
                            this.selectedIds = [];
                            this.showToast('æ‰¹é‡å¯ç”¨æˆåŠŸ', 'success', `å·²å¯ç”¨ ${count} ä¸ªæœºæ„`);
                            this.confirmModal.open = false;
                        }
                    };
                },

                batchDisable() {
                    const count = this.selectedIds.length;
                    this.confirmModal = {
                        open: true,
                        type: 'danger',
                        title: `ç¡®è®¤æ‰¹é‡åœç”¨ ${count} ä¸ªæœºæ„ï¼Ÿ`,
                        message: 'åœç”¨åï¼Œé€‰ä¸­çš„æœºæ„å°†æ— æ³•è¿›è¡Œèµ„é‡‘è®¡åˆ’å½•å…¥ï¼Œå·²æœ‰æ•°æ®ä¸å—å½±å“ã€‚',
                        confirmText: 'ç¡®è®¤åœç”¨',
                        icon: 'fa-ban',
                        onConfirm: () => {
                            const today = new Date().toISOString().split('T')[0];
                            this.selectedIds.forEach(id => {
                                const item = this.dataList.find(d => d.id === id);
                                if (item) {
                                    item.status = 'disabled';
                                    item.updateDate = today;
                                }
                            });
                            this.selectedIds = [];
                            this.showToast('æ‰¹é‡åœç”¨æˆåŠŸ', 'warning', `å·²åœç”¨ ${count} ä¸ªæœºæ„`);
                            this.confirmModal.open = false;
                        }
                    };
                },

                refreshData() {
                    this.loading = true;
                    setTimeout(() => {
                        this.loading = false;
                        this.showToast('æ•°æ®å·²åˆ·æ–°', 'success', 'å·²åŒæ­¥ç”¨æˆ·ä¸­å¿ƒæœ€æ–°æ•°æ®');
                    }, 800);
                },

                showToast(title, type = 'success', message = '') {
                    if (this.toast.timer) clearTimeout(this.toast.timer);
                    this.toast = { show: true, type, title, message };
                    this.toast.timer = setTimeout(() => {
                        this.toast.show = false;
                    }, 3000);
                }
            }
        }
    </script>
</body>
</html>
