<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒºåŸŸå…¨æ™¯ç”»åƒ(ä¸œåŒ—) | æ™ºé—®é€šè¾¾</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- WordCloud2.js -->
    <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.2.2/src/wordcloud2.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans SC"', 'sans-serif'],
                    },
                    colors: {
                        cqc: {
                            blue: '#005bac',
                            dark: '#1e293b',
                            light: '#f1f5f9',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        html { scroll-behavior: smooth; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .anchor-link.active {
            color: #2563eb;
            border-right: 3px solid #2563eb;
            background: linear-gradient(270deg, #eff6ff 0%, rgba(255,255,255,0) 100%);
        }
        .dropdown-check-item:hover { background-color: #f1f5f9; }
        #word-cloud-canvas { width: 100%; height: 100%; cursor: pointer; }
        
        /* çƒ­åŠ›å›¾å•å…ƒæ ¼åŠ¨ç”» */
        .heatmap-cell:hover { transform: scale(1.05); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); z-index: 10; border-color: #fff; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans h-screen flex overflow-hidden">

    <!-- å·¦ä¾§å¯¼èˆª -->


    <!-- ä¸»å†…å®¹åŒº -->
    <main class="flex-1 flex flex-col min-w-0 relative">
        
        <!-- é¡¶éƒ¨ç­›é€‰æ  -->
        <header class="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8 sticky top-0 z-20 shadow-sm">
            <div class="flex items-center gap-6">
                <h1 class="text-lg font-bold text-slate-800">ä¸œåŒ—åŒºåŸŸ Â· è®¤è¯å¤§æ•°æ®çœ‹æ¿</h1>
                
                <div class="flex items-center gap-2 bg-slate-100 px-3 py-1.5 rounded-md border border-slate-200 opacity-80 cursor-not-allowed" title="å½“å‰é”å®šä¸ºä¸œåŒ—åŒºåŸŸ">
                    <i class="fa-solid fa-location-dot text-slate-500"></i>
                    <span class="text-sm font-bold text-slate-700">ä¸œåŒ—å¤§åŒº (è¾½/å‰/é»‘)</span>
                </div>

                <div class="relative group">
                    <button class="flex items-center gap-2 bg-white px-3 py-1.5 rounded-md border border-blue-200 hover:border-blue-500 transition-colors">
                        <i class="fa-solid fa-layer-group text-blue-600"></i>
                        <span class="text-sm font-bold text-slate-700">è¡Œä¸šèŒƒå›´ï¼šå…¨éƒ¨ (12ä¸ª)</span>
                        <i class="fa-solid fa-chevron-down text-xs text-slate-400 ml-2"></i>
                    </button>
                    <!-- Dropdown Content (Mock) -->
                    <div class="absolute top-full left-0 mt-1 w-64 bg-white border border-slate-200 rounded-lg shadow-xl hidden group-hover:block p-2 z-50">
                        <div class="flex items-center justify-between px-2 py-1 mb-1 border-b border-slate-100">
                            <span class="text-xs font-bold text-slate-500">å¤šé€‰è¡Œä¸š</span>
                            <span class="text-xs text-blue-600 cursor-pointer">å…¨é€‰</span>
                        </div>
                        <div class="max-h-60 overflow-y-auto space-y-1">
                            <label class="flex items-center gap-2 px-2 py-1.5 dropdown-check-item rounded cursor-pointer"><input type="checkbox" checked class="accent-blue-600"> <span class="text-sm">é«˜ç«¯è£…å¤‡åˆ¶é€ </span></label>
                            <label class="flex items-center gap-2 px-2 py-1.5 dropdown-check-item rounded cursor-pointer"><input type="checkbox" checked class="accent-blue-600"> <span class="text-sm">æ±½è½¦åŠé›¶éƒ¨ä»¶</span></label>
                            <label class="flex items-center gap-2 px-2 py-1.5 dropdown-check-item rounded cursor-pointer"><input type="checkbox" checked class="accent-blue-600"> <span class="text-sm">çŸ³æ²¹åŒ–å·¥</span></label>
                            <label class="flex items-center gap-2 px-2 py-1.5 dropdown-check-item rounded cursor-pointer"><input type="checkbox" checked class="accent-blue-600"> <span class="text-sm">å†œäº§å“ä¸é£Ÿå“</span></label>
                            <label class="flex items-center gap-2 px-2 py-1.5 dropdown-check-item rounded cursor-pointer"><input type="checkbox" checked class="accent-blue-600"> <span class="text-sm">ç”µå­ä¿¡æ¯</span></label>
                            <label class="flex items-center gap-2 px-2 py-1.5 dropdown-check-item rounded cursor-pointer"><input type="checkbox" checked class="accent-blue-600"> <span class="text-sm">ç”Ÿç‰©åŒ»è¯</span></label>
                        </div>
                        <div class="pt-2 mt-2 border-t border-slate-100 text-center">
                            <button class="w-full bg-blue-600 text-white text-xs py-1.5 rounded hover:bg-blue-700">ç¡®è®¤ç­›é€‰</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex items-center gap-3">
                 <button class="text-slate-500 hover:text-blue-600 p-2 rounded-full hover:bg-slate-100" title="åˆ·æ–°æ•°æ®" onclick="window.location.reload()"><i class="fa-solid fa-arrows-rotate"></i></button>
                 <button class="text-slate-500 hover:text-blue-600 p-2 rounded-full hover:bg-slate-100" title="å…¨å±æ¨¡å¼"><i class="fa-solid fa-expand"></i></button>
            </div>
        </header>

        <!-- å†…å®¹æ»šåŠ¨åŒº -->
        <div id="scroll-container" class="flex-1 overflow-y-auto scroll-smooth p-6 bg-slate-100">
            <div class="flex gap-6 max-w-[1920px] mx-auto">
                
                <!-- ä¸»ä½“å†…å®¹ -->
                <div class="flex-1 space-y-6">
                    
                    <!-- 1. KPI æ¦‚è§ˆ -->
                    <section id="section-overview" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 scroll-mt-24">
                        <!-- Cards with Drilldown -->
                        <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 border-l-4 border-l-blue-500 flex justify-between items-center cursor-pointer hover:shadow-md transition-all group" onclick="openDrillDown('è·è¯ä¼ä¸šåå½•', 'enterprises')">
                            <div>
                                <p class="text-slate-500 text-xs font-bold uppercase">å…¨åŒºåŸŸè·è¯ä¼ä¸š</p>
                                <h3 class="text-2xl font-bold text-slate-800 mt-1">12,450 <span class="text-xs font-normal text-slate-400">å®¶</span></h3>
                                <p class="text-xs text-green-600 mt-1"><i class="fa-solid fa-arrow-trend-up"></i> +4.2% åŒæ¯”</p>
                            </div>
                            <div class="w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-600 group-hover:scale-110 transition-transform">
                                <i class="fa-solid fa-building"></i>
                            </div>
                        </div>
                        <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 border-l-4 border-l-indigo-500 flex justify-between items-center cursor-pointer hover:shadow-md transition-all group" onclick="openDrillDown('æœ‰æ•ˆè¯ä¹¦æ˜ç»†', 'certs')">
                            <div>
                                <p class="text-slate-500 text-xs font-bold uppercase">æœ‰æ•ˆè¯ä¹¦ä¿æœ‰é‡</p>
                                <h3 class="text-2xl font-bold text-slate-800 mt-1">48,201 <span class="text-xs font-normal text-slate-400">å¼ </span></h3>
                                <p class="text-xs text-green-600 mt-1"><i class="fa-solid fa-arrow-trend-up"></i> +6.8% åŒæ¯”</p>
                            </div>
                            <div class="w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-600 group-hover:scale-110 transition-transform">
                                <i class="fa-solid fa-certificate"></i>
                            </div>
                        </div>
                        <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 border-l-4 border-l-emerald-500 flex justify-between items-center cursor-pointer hover:shadow-md transition-all group" onclick="openDrillDown('äº§ä¸šäº§å€¼åˆ†æ', 'value')">
                            <div>
                                <p class="text-slate-500 text-xs font-bold uppercase">å…³è”äº§ä¸šäº§å€¼ä¼°ç®—</p>
                                <h3 class="text-2xl font-bold text-slate-800 mt-1">8,500 <span class="text-xs font-normal text-slate-400">äº¿</span></h3>
                                <p class="text-xs text-slate-400 mt-1">åŸºäºè·è¯ä¼ä¸šå¹´æŠ¥</p>
                            </div>
                            <div class="w-12 h-12 bg-emerald-50 rounded-full flex items-center justify-center text-emerald-600 group-hover:scale-110 transition-transform">
                                <i class="fa-solid fa-coins"></i>
                            </div>
                        </div>
                         <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 border-l-4 border-l-orange-500 flex justify-between items-center cursor-pointer hover:shadow-md transition-all group" onclick="openDrillDown('é«˜é£é™©ä¼ä¸šæ¸…å•', 'risk_list')">
                            <div>
                                <p class="text-slate-500 text-xs font-bold uppercase">é«˜é£é™©é¢„è­¦ä¼ä¸š</p>
                                <h3 class="text-2xl font-bold text-slate-800 mt-1">342 <span class="text-xs font-normal text-slate-400">å®¶</span></h3>
                                <p class="text-xs text-red-500 mt-1"><i class="fa-solid fa-circle-exclamation"></i> éœ€é‡ç‚¹ç¨½æŸ¥</p>
                            </div>
                            <div class="w-12 h-12 bg-orange-50 rounded-full flex items-center justify-center text-orange-600 group-hover:scale-110 transition-transform">
                                <i class="fa-solid fa-bell"></i>
                            </div>
                        </div>
                    </section>

                    <!-- 2. è¡Œä¸šæ„æˆä¸ä»·å€¼ (Composition) -->
                    <section id="section-composition" class="scroll-mt-24">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="font-bold text-slate-800">å…¨è¡Œä¸šè¯ä¹¦é‡å æ¯”</h3>
                                    <button class="text-xs text-blue-600 hover:underline" onclick="openDrillDown('è¡Œä¸šç»†åˆ†æ„æˆ', 'industry_pie')">æŸ¥çœ‹è¯¦æƒ…</button>
                                </div>
                                <div class="h-60">
                                    <canvas id="industryPieChart"></canvas>
                                </div>
                            </div>
                            <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="font-bold text-slate-800">è¡Œä¸šä»·å€¼çŸ©é˜µ (è§„æ¨¡ vs å¢é€Ÿ vs äº§å€¼)</h3>
                                    <span class="text-xs text-slate-400">æ°”æ³¡å¤§å° = äº§å€¼è§„æ¨¡</span>
                                </div>
                                <div class="h-60">
                                    <canvas id="industryBubbleChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 3. åŒºåŸŸä¸çƒ­åŠ› (Geo & Heatmap) -->
                    <section id="section-geo" class="scroll-mt-24">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <h3 class="font-bold text-slate-800 mb-4">ä¸œåŒ—ä¸‰çœè®¤è¯æ´»è·ƒåº¦å¯¹æ¯”</h3>
                                <div class="h-64">
                                    <canvas id="provinceBarChart"></canvas>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="font-bold text-slate-800">é‡ç‚¹åŸå¸‚ Ã— è¡Œä¸š å¯†åº¦çƒ­åŠ›å›¾</h3>
                                    <span class="text-xs text-slate-400">é¢œè‰²è¶Šæ·±ä»£è¡¨ä¼ä¸šè¶Šå¯†é›†</span>
                                </div>
                                <div class="h-64 flex flex-col justify-center" id="heatmap-container">
                                    <!-- HTML Generated Heatmap -->
                                    <div class="grid grid-cols-6 gap-1 text-xs text-center">
                                        <div class="font-bold text-slate-500"></div>
                                        <div class="font-bold text-slate-500">è£…å¤‡</div>
                                        <div class="font-bold text-slate-500">æ±½è½¦</div>
                                        <div class="font-bold text-slate-500">åŒ–å·¥</div>
                                        <div class="font-bold text-slate-500">å†œé£Ÿ</div>
                                        <div class="font-bold text-slate-500">ç”µå­</div>

                                        <div class="font-bold text-slate-500 self-center">æ²ˆé˜³</div>
                                        <div class="bg-blue-600 text-white p-2 rounded heatmap-cell cursor-pointer" title="æ²ˆé˜³-è£…å¤‡: 520å®¶" onclick="openDrillDown('æ²ˆé˜³-è£…å¤‡åˆ¶é€ ä¼ä¸š', 'heatmap_list')">Hi</div>
                                        <div class="bg-blue-400 text-white p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('æ²ˆé˜³-æ±½è½¦ä¼ä¸š', 'heatmap_list')">Med</div>
                                        <div class="bg-blue-200 text-slate-700 p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('æ²ˆé˜³-åŒ–å·¥ä¼ä¸š', 'heatmap_list')">Low</div>
                                        <div class="bg-blue-200 text-slate-700 p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('æ²ˆé˜³-å†œé£Ÿä¼ä¸š', 'heatmap_list')">Low</div>
                                        <div class="bg-blue-300 text-slate-800 p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('æ²ˆé˜³-ç”µå­ä¼ä¸š', 'heatmap_list')">Mid</div>

                                        <div class="font-bold text-slate-500 self-center">é•¿æ˜¥</div>
                                        <div class="bg-blue-300 text-slate-800 p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('é•¿æ˜¥-è£…å¤‡ä¼ä¸š', 'heatmap_list')">Mid</div>
                                        <div class="bg-blue-700 text-white p-2 rounded heatmap-cell cursor-pointer" title="é•¿æ˜¥-æ±½è½¦: 850å®¶" onclick="openDrillDown('é•¿æ˜¥-æ±½è½¦ä¼ä¸š', 'heatmap_list')">V.Hi</div>
                                        <div class="bg-blue-100 text-slate-600 p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('é•¿æ˜¥-åŒ–å·¥ä¼ä¸š', 'heatmap_list')">Low</div>
                                        <div class="bg-blue-500 text-white p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('é•¿æ˜¥-å†œé£Ÿä¼ä¸š', 'heatmap_list')">Hi</div>
                                        <div class="bg-blue-200 text-slate-700 p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('é•¿æ˜¥-ç”µå­ä¼ä¸š', 'heatmap_list')">Low</div>
                                        
                                        <div class="font-bold text-slate-500 self-center">å¤§è¿</div>
                                        <div class="bg-blue-500 text-white p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('å¤§è¿-è£…å¤‡ä¼ä¸š', 'heatmap_list')">Hi</div>
                                        <div class="bg-blue-200 text-slate-700 p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('å¤§è¿-æ±½è½¦ä¼ä¸š', 'heatmap_list')">Low</div>
                                        <div class="bg-blue-600 text-white p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('å¤§è¿-åŒ–å·¥ä¼ä¸š', 'heatmap_list')">Hi</div>
                                        <div class="bg-blue-400 text-white p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('å¤§è¿-å†œé£Ÿä¼ä¸š', 'heatmap_list')">Med</div>
                                        <div class="bg-blue-500 text-white p-2 rounded heatmap-cell cursor-pointer" onclick="openDrillDown('å¤§è¿-ç”µå­ä¼ä¸š', 'heatmap_list')">Hi</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 4. æ•ˆç‡ä¸å¥åº·åº¦ (Efficiency & Health) -->
                    <section id="section-efficiency" class="scroll-mt-24">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Scatter: Lab Cycle Time vs Pass Rate -->
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <h3 class="font-bold text-slate-800 mb-4">æŠ€æœ¯æˆç†Ÿåº¦åˆ†æ (æ£€æµ‹å‘¨æœŸ vs é€šè¿‡ç‡)</h3>
                                <div class="h-64">
                                    <canvas id="efficiencyScatterChart"></canvas>
                                </div>
                                <p class="text-xs text-slate-400 mt-2 text-center">æ¨ªè½´ï¼šå¹³å‡æ£€æµ‹å‘¨æœŸ(å¤©) | çºµè½´ï¼šä¸€æ¬¡é€šè¿‡ç‡(%) | é¢œè‰²ï¼šæ•ˆç‡è¯„åˆ†</p>
                            </div>
                            <!-- Mixed: New vs Churn -->
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <h3 class="font-bold text-slate-800 mb-4">è¡Œä¸šå¥åº·åº¦ (æ–°å¢å‘è¯ vs æš‚åœæ’¤é”€)</h3>
                                <div class="h-64">
                                    <canvas id="churnMixedChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 5. å¯æŒç»­å‘å±•ä¸ç»“æ„ (Sustainability & Structure) -->
                    <section id="section-sustainability" class="scroll-mt-24">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Polar Area: Green Certs -->
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <h3 class="font-bold text-slate-800 mb-4">ç»¿è‰²ä½ç¢³è®¤è¯åˆ†å¸ƒ</h3>
                                <div class="h-60 flex justify-center">
                                    <canvas id="greenPolarChart"></canvas>
                                </div>
                            </div>
                            <!-- Stacked Bar: Age Structure -->
                            <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <h3 class="font-bold text-slate-800 mb-4">å®¢æˆ·ç²˜æ€§åˆ†æ (è¯ä¹¦æŒè¯å¹´é™ç»“æ„)</h3>
                                <div class="h-60">
                                    <canvas id="ageStructureChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 6. è¶‹åŠ¿ä¸ç±»å‹ (Trend & Type) -->
                    <section id="section-trend" class="scroll-mt-24">
                         <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                            <h3 class="font-bold text-slate-800 mb-4">é‡ç‚¹è¡Œä¸šå‘è¯é‡è¶‹åŠ¿ (è¿‘12ä¸ªæœˆ)</h3>
                            <div class="h-64">
                                <canvas id="trendLineChart"></canvas>
                            </div>
                        </div>
                    </section>

                    <!-- 7. åˆè§„ä¸çƒ­ç‚¹ (Compliance & Words) -->
                    <section id="section-compliance" class="scroll-mt-24">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Gauge (Doughnut simulated) -->
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col items-center justify-center">
                                <h3 class="font-bold text-slate-800 mb-2 w-full text-left">åŒºåŸŸåˆè§„ä¿¡å¿ƒæŒ‡æ•°</h3>
                                <div class="relative w-48 h-48">
                                    <canvas id="complianceGaugeChart"></canvas>
                                    <div class="absolute inset-0 flex flex-col items-center justify-center pt-8">
                                        <span class="text-4xl font-bold text-blue-600">87.5</span>
                                        <span class="text-xs text-slate-400">åˆ† (è‰¯å¥½)</span>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500 mt-2 text-center w-3/4">åŸºäºç›‘ç£æŠ½æŸ¥åˆæ ¼ç‡ä¸å¹´æ£€é€šè¿‡ç‡ç»¼åˆè®¡ç®—</p>
                            </div>
                            <!-- Word Cloud -->
                            <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="font-bold text-slate-800"><i class="fa-solid fa-cloud text-blue-400 mr-2"></i> è¡Œä¸šçƒ­ç‚¹è¯äº‘</h3>
                                    <div class="flex gap-2 text-xs">
                                        <span class="px-2 py-1 bg-blue-50 text-blue-600 rounded">çƒ­é—¨æ ‡å‡†</span>
                                        <span class="px-2 py-1 bg-slate-100 text-slate-500 rounded">æ–°å…´äº§å“</span>
                                    </div>
                                </div>
                                <div class="h-56 w-full relative bg-slate-50 rounded-lg border border-slate-100 overflow-hidden cursor-pointer hover:shadow-inner transition-shadow" onclick="openDrillDown('è¡Œä¸šçƒ­ç‚¹è¯é¢‘åˆ†æ', 'word_cloud_detail')">
                                    <canvas id="word-cloud-canvas"></canvas>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Footer -->
                    <div class="text-center text-xs text-slate-400 pt-8 pb-12">
                        Â© 2026 CQC è®¤è¯å¤§æ•°æ®ä¸­å¿ƒ
                    </div>
                </div>

                <!-- å³ä¾§æ‚¬æµ®å¯¼èˆª -->
                <nav class="hidden 2xl:block w-40 sticky top-24 h-fit pl-4 border-l border-slate-200">
                    <h3 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">è§†å›¾å¯¼èˆª</h3>
                    <ul class="space-y-1">
                        <li><a href="#section-overview" class="anchor-link active block text-sm text-slate-600 hover:text-blue-600 py-1.5 px-3 rounded-r-md transition-all">æ ¸å¿ƒæŒ‡æ ‡</a></li>
                        <li><a href="#section-composition" class="anchor-link block text-sm text-slate-600 hover:text-blue-600 py-1.5 px-3 rounded-r-md transition-all">è¡Œä¸šæ„æˆ</a></li>
                        <li><a href="#section-geo" class="anchor-link block text-sm text-slate-600 hover:text-blue-600 py-1.5 px-3 rounded-r-md transition-all">åŒºåŸŸçƒ­åŠ›</a></li>
                        <li><a href="#section-efficiency" class="anchor-link block text-sm text-slate-600 hover:text-blue-600 py-1.5 px-3 rounded-r-md transition-all">æ•ˆç‡ä¸å¥åº·</a></li>
                        <li><a href="#section-sustainability" class="anchor-link block text-sm text-slate-600 hover:text-blue-600 py-1.5 px-3 rounded-r-md transition-all">æŒç»­å‘å±•</a></li>
                        <li><a href="#section-trend" class="anchor-link block text-sm text-slate-600 hover:text-blue-600 py-1.5 px-3 rounded-r-md transition-all">è¶‹åŠ¿åˆ†æ</a></li>
                        <li><a href="#section-compliance" class="anchor-link block text-sm text-slate-600 hover:text-blue-600 py-1.5 px-3 rounded-r-md transition-all">åˆè§„çƒ­ç‚¹</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </main>

    <!-- å¢å¼ºç‰ˆé€šç”¨ä¸‹é’»å¼¹çª— (Smart Drilldown Modal) -->
    <div id="commonModal" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-slate-900 bg-opacity-50 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="fixed inset-0 z-10 overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-5xl">
                    <!-- Header -->
                    <div class="bg-slate-50 px-4 py-3 sm:px-6 flex justify-between items-center border-b border-slate-200">
                        <h3 class="text-lg font-bold leading-6 text-slate-900" id="modal-title">è¯¦æƒ…æ•°æ®</h3>
                        <button onclick="closeModal()" class="text-slate-400 hover:text-slate-500"><i class="fa-solid fa-xmark text-xl"></i></button>
                    </div>
                    
                    <!-- Dynamic Filter Bar -->
                    <div id="modal-filters" class="bg-white px-4 py-3 border-b border-slate-100 flex flex-wrap gap-3 items-center">
                        <!-- Filters injected by JS -->
                    </div>

                    <!-- Dynamic Body -->
                    <div class="px-4 py-5 sm:p-6 h-[500px] overflow-y-auto bg-slate-50" id="modal-content">
                        <!-- Content injected by JS -->
                        <div class="flex justify-center items-center h-full text-slate-400">
                            <i class="fa-solid fa-circle-notch fa-spin mr-2"></i> åŠ è½½æ•°æ®ä¸­...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. Charts Initialization ---

        // Chart 1: Industry Pie (Doughnut)
        new Chart(document.getElementById('industryPieChart'), {
            type: 'doughnut',
            data: {
                labels: ['é«˜ç«¯è£…å¤‡', 'æ±½è½¦', 'åŒ–å·¥', 'å†œé£Ÿ', 'ç”µå­', 'å…¶ä»–'],
                datasets: [{ data: [30, 25, 15, 12, 10, 8], backgroundColor: ['#3b82f6', '#6366f1', '#14b8a6', '#f59e0b', '#8b5cf6', '#cbd5e1'], borderWidth: 0 }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' } }, onClick: () => openDrillDown('é«˜ç«¯è£…å¤‡åˆ¶é€ è¡Œä¸š - ç»†åˆ†ç”»åƒ', 'industry_pie') }
        });

        // Chart 2: Bubble (Value Matrix)
        new Chart(document.getElementById('industryBubbleChart'), {
            type: 'bubble',
            data: {
                datasets: [{
                    label: 'è¡Œä¸šç”»åƒ',
                    data: [
                        {x: 20, y: 30, r: 15, industry: 'è£…å¤‡'}, 
                        {x: 40, y: 10, r: 10, industry: 'æ±½è½¦'}, 
                        {x: 10, y: 50, r: 25, industry: 'åŒ–å·¥'},
                        {x: 30, y: 20, r: 8, industry: 'å†œé£Ÿ'},
                        {x: 25, y: 40, r: 12, industry: 'ç”µå­'}
                    ],
                    backgroundColor: 'rgba(37, 99, 235, 0.6)', borderColor: '#2563eb'
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, onClick: () => openDrillDown('é«˜ä»·å€¼ä¼ä¸šçŸ©é˜µåˆ†æ', 'bubble_matrix') }
        });

        // Chart 3: Province Bar
        new Chart(document.getElementById('provinceBarChart'), {
            type: 'bar',
            data: { labels: ['è¾½å®', 'å‰æ—', 'é»‘é¾™æ±Ÿ'], datasets: [{ label: 'è·è¯ä¼ä¸š', data: [4500, 3200, 2800], backgroundColor: '#3b82f6' }, { label: 'æœ‰æ•ˆè¯ä¹¦', data: [15000, 11000, 9500], backgroundColor: '#93c5fd' }] },
            options: { responsive: true, maintainAspectRatio: false, onClick: () => openDrillDown('åˆ†çœä¸šåŠ¡æ•°æ®è¯¦æƒ…', 'province_list') }
        });

        // Chart 5: Trend Line
        new Chart(document.getElementById('trendLineChart'), {
            type: 'line',
            data: {
                labels: ['1æœˆ','2æœˆ','3æœˆ','4æœˆ','5æœˆ','6æœˆ','7æœˆ','8æœˆ','9æœˆ','10æœˆ','11æœˆ','12æœˆ'],
                datasets: [
                    { label: 'è£…å¤‡åˆ¶é€ ', data: [120,132,101,134,90,230,210,220,230,250,270,300], borderColor: '#3b82f6', tension: 0.4 },
                    { label: 'æ±½è½¦éƒ¨ä»¶', data: [220,182,191,234,290,330,310,300,310,320,340,360], borderColor: '#6366f1', tension: 0.4 },
                    { label: 'å†œé£Ÿäº§å“', data: [150,232,201,154,190,330,410,400,380,360,340,320], borderColor: '#f59e0b', tension: 0.4 }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, onClick: () => openDrillDown('æœˆåº¦å‘è¯ä¸šåŠ¡æµæ°´', 'trend_detail') }
        });

        // Chart 10: Scatter (Efficiency)
        new Chart(document.getElementById('efficiencyScatterChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'è¡Œä¸šæŠ€æœ¯æˆç†Ÿåº¦',
                    data: [
                        {x: 15, y: 95, industry: 'ç”µå­ä¿¡æ¯'}, {x: 45, y: 80, industry: 'é«˜ç«¯è£…å¤‡'}, 
                        {x: 25, y: 92, industry: 'æ±½è½¦éƒ¨ä»¶'}, {x: 10, y: 88, industry: 'å†œé£Ÿäº§å“'}, {x: 35, y: 75, industry: 'çŸ³æ²¹åŒ–å·¥'}
                    ],
                    backgroundColor: (ctx) => {
                        const val = ctx.raw?.y;
                        return val > 90 ? '#22c55e' : (val < 80 ? '#f97316' : '#3b82f6');
                    }
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: { x: { title: {display:true, text:'å¹³å‡æ£€æµ‹å‘¨æœŸ(å¤©)'}}, y: { title: {display:true, text:'ä¸€æ¬¡é€šè¿‡ç‡(%)'}, min: 60, max: 100 } },
                plugins: { tooltip: { callbacks: { label: (ctx) => `${ctx.raw.industry}: ${ctx.raw.x}å¤©, ${ctx.raw.y}%` } } },
                onClick: () => openDrillDown('å®éªŒå®¤æ£€æµ‹æ•ˆç‡ä¸è´¨é‡åˆ†æ', 'efficiency_list')
            }
        });

        // Chart 11: Mixed (Churn)
        new Chart(document.getElementById('churnMixedChart'), {
            type: 'bar',
            data: {
                labels: ['è£…å¤‡', 'æ±½è½¦', 'åŒ–å·¥', 'å†œé£Ÿ', 'ç”µå­'],
                datasets: [
                    { type: 'bar', label: 'æ–°å¢å‘è¯', data: [500, 600, 200, 350, 400], backgroundColor: '#3b82f6' },
                    { type: 'line', label: 'æ’¤é”€/æš‚åœç‡(%)', data: [2.5, 1.8, 5.2, 3.1, 2.0], borderColor: '#ef4444', yAxisID: 'y1' }
                ]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: { y: { position: 'left' }, y1: { position: 'right', grid: {drawOnChartArea: false} } },
                onClick: () => openDrillDown('è¡Œä¸šæµå¤±ä¸å¥åº·åº¦åˆ†æ', 'churn_detail')
            }
        });

        // Chart 12: Polar Area (Green)
        new Chart(document.getElementById('greenPolarChart'), {
            type: 'polarArea',
            data: {
                labels: ['èŠ‚èƒ½è®¤è¯', 'èŠ‚æ°´è®¤è¯', 'ä½ç¢³äº§å“', 'RoHS', 'ç»¿è‰²å»ºæ'],
                datasets: [{ data: [1500, 800, 1200, 2000, 600], backgroundColor: ['#4ade80', '#60a5fa', '#2dd4bf', '#fbbf24', '#a78bfa'] }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } }, onClick: () => openDrillDown('ç»¿è‰²ä½ç¢³è®¤è¯ä¸“é¡¹æŠ¥è¡¨', 'green_detail') }
        });

        // Chart 13: Stacked Bar (Age Structure)
        new Chart(document.getElementById('ageStructureChart'), {
            type: 'bar',
            data: {
                labels: ['è£…å¤‡', 'æ±½è½¦', 'åŒ–å·¥', 'å†œé£Ÿ', 'ç”µå­'],
                datasets: [
                    { label: '<1å¹´(æ–°å®¢)', data: [20, 25, 10, 15, 30], backgroundColor: '#93c5fd' },
                    { label: '1-3å¹´(æˆé•¿æœŸ)', data: [40, 35, 30, 45, 40], backgroundColor: '#3b82f6' },
                    { label: '3-5å¹´(ç¨³å®šæœŸ)', data: [25, 30, 40, 30, 20], backgroundColor: '#1d4ed8' },
                    { label: '>5å¹´(å¿ è¯š)', data: [15, 10, 20, 10, 10], backgroundColor: '#1e3a8a' }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true }, y: { stacked: true } }, onClick: () => openDrillDown('å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä¸ç²˜æ€§åˆ†æ', 'age_detail') }
        });

        // Chart 14: Gauge (Simulated with Doughnut)
        new Chart(document.getElementById('complianceGaugeChart'), {
            type: 'doughnut',
            data: {
                labels: ['åˆè§„', 'é£é™©'],
                datasets: [{ data: [87.5, 12.5], backgroundColor: ['#3b82f6', '#f1f5f9'], circumference: 180, rotation: 270, borderWidth: 0 }]
            },
            options: { responsive: true, maintainAspectRatio: false, cutout: '80%', plugins: { legend: { display: false }, tooltip: { enabled: false } }, onClick: () => openDrillDown('åˆè§„ç¨½æŸ¥ä¸é£é™©æ—¥å¿—', 'compliance_log') }
        });


        // --- 2. Word Cloud Implementation (Rich Data) ---
        function initWordCloud() {
            const canvas = document.getElementById('word-cloud-canvas');
            const options = {
                list: [
                    ['ISO9001', 80], ['CCCè®¤è¯', 70], ['æ–°èƒ½æºæ±½è½¦', 60], ['æ™ºèƒ½åˆ¶é€ ', 55], 
                    ['ç»¿è‰²å·¥å‚', 50], ['ç¢³è¶³è¿¹', 45], ['æœ‰æœºäº§å“', 40], ['IATF16949', 40],
                    ['èŠ‚èƒ½è®¤è¯', 38], ['RoHS', 35], ['ä¿¡æ¯å®‰å…¨', 32], ['HACCP', 30],
                    ['æœºå™¨äººCR', 28], ['é˜²çˆ†ç”µæ°”', 28], ['æ— äººæœº', 25], ['5Gé€šä¿¡', 25],
                    ['ç‰¹ç§è®¾å¤‡', 24], ['ISO14001', 22], ['ISO45001', 20], ['è½¦è”ç½‘', 18],
                    ['å…‰ä¼é€†å˜å™¨', 18], ['é£ç”µå¶ç‰‡', 16], ['åŒ»ç–—å™¨æ¢°', 15], ['è½¨é“äº¤é€š', 15],
                    ['æ™ºèƒ½ç½‘è”', 14], ['æ•°æ®å®‰å…¨', 12], ['åŒç¢³', 12], ['ç»¿è‰²å»ºæ', 10],
                    ['å›½æ¨æ¼«æ¸¸', 10], ['å‚¨èƒ½ç³»ç»Ÿ', 10]
                ],
                gridSize: 6, weightFactor: 1.2, fontFamily: '"Noto Sans SC", sans-serif', color: (word, weight) => weight > 50 ? '#2563eb' : (weight > 30 ? '#0ea5e9' : '#94a3b8'), backgroundColor: 'transparent',
                rotateRatio: 0
            };
            WordCloud(canvas, options);
        }
        setTimeout(initWordCloud, 500);


        // --- 3. Dynamic Content Generators ---

        function openDrillDown(title, type) {
            const modal = document.getElementById('commonModal');
            const modalTitle = document.getElementById('modal-title');
            const filterContainer = document.getElementById('modal-filters');
            const contentContainer = document.getElementById('modal-content');
            
            modal.classList.remove('hidden');
            modalTitle.innerText = title;
            filterContainer.innerHTML = generateFilters(type);
            
            contentContainer.innerHTML = '<div class="flex justify-center items-center h-full text-slate-400"><i class="fa-solid fa-circle-notch fa-spin mr-2"></i> æ•°æ®åŠ è½½ä¸­...</div>';

            setTimeout(() => {
                let contentHTML = '';
                switch(type) {
                    case 'industry_pie': contentHTML = generateIndustryPieDetail(); break;
                    case 'bubble_matrix': contentHTML = generateValueMatrixDetail(); break;
                    case 'efficiency_list': contentHTML = generateEfficiencyTable(); break;
                    case 'trend_detail': contentHTML = generateTrendDetail(); break;
                    case 'churn_detail': contentHTML = generateChurnDetail(); break;
                    case 'green_detail': contentHTML = generateGreenDetail(); break;
                    case 'age_detail': contentHTML = generateAgeDetail(); break;
                    case 'compliance_log': contentHTML = generateComplianceDetail(); break;
                    case 'word_cloud_detail': contentHTML = generateWordCloudDetail(); break;
                    default: contentHTML = generateStandardTable(type); // Fallback
                }
                contentContainer.innerHTML = contentHTML;
            }, 300);
        }

        function generateFilters(type) {
            let base = `
                <div class="relative">
                    <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-xs"></i>
                    <input type="text" placeholder="æœç´¢..." class="pl-8 pr-3 py-1.5 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 w-48">
                </div>
            `;
            if (type === 'green_detail') {
                base += `<select class="py-1.5 pl-2 text-sm border border-slate-300 rounded-md"><option>æ‰€æœ‰ç»¿è‰²ç±»åˆ«</option><option>èŠ‚èƒ½</option><option>RoHS</option></select>`;
            } else if (type === 'compliance_log') {
                base += `<select class="py-1.5 pl-2 text-sm border border-slate-300 rounded-md"><option>æ‰€æœ‰é£é™©ç­‰çº§</option><option>é«˜é£é™©</option><option>ä¸­é£é™©</option></select>`;
            } else {
                base += `<select class="py-1.5 pl-2 text-sm border border-slate-300 rounded-md"><option>æ‰€æœ‰åŸå¸‚</option><option>æ²ˆé˜³</option><option>å¤§è¿</option><option>é•¿æ˜¥</option></select>`;
            }
            return base + `<button class="bg-blue-600 text-white px-3 py-1.5 rounded-md text-sm ml-auto hover:bg-blue-700">å¯¼å‡º</button>`;
        }

        // --- Content Generators (HTML Strings) ---

        function generateIndustryPieDetail() {
            return `
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div class="bg-white p-4 rounded border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-800 mb-3 border-l-4 border-blue-500 pl-2">é«˜ç«¯è£…å¤‡ç»†åˆ†é¢†åŸŸ</h4>
                        <div class="space-y-3">
                            <div><div class="flex justify-between text-sm mb-1"><span>æ•°æ§æœºåºŠ</span><span class="font-bold">35%</span></div><div class="w-full bg-slate-100 rounded-full h-2"><div class="bg-blue-500 h-2 rounded-full" style="width: 35%"></div></div></div>
                            <div><div class="flex justify-between text-sm mb-1"><span>è½¨é“äº¤é€šè£…å¤‡</span><span class="font-bold">28%</span></div><div class="w-full bg-slate-100 rounded-full h-2"><div class="bg-blue-400 h-2 rounded-full" style="width: 28%"></div></div></div>
                            <div><div class="flex justify-between text-sm mb-1"><span>æœºå™¨äººä¸æ™ºèƒ½è£…å¤‡</span><span class="font-bold">22%</span></div><div class="w-full bg-slate-100 rounded-full h-2"><div class="bg-blue-300 h-2 rounded-full" style="width: 22%"></div></div></div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-800 mb-3 border-l-4 border-indigo-500 pl-2">è¯¥é¢†åŸŸå¤´éƒ¨ä¼ä¸š TOP 5</h4>
                        <ul class="divide-y divide-slate-100 text-sm">
                            <li class="py-2 flex justify-between items-center"><span>æ²ˆé˜³é¼“é£æœºé›†å›¢</span><span class="bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">AAAçº§</span></li>
                            <li class="py-2 flex justify-between items-center"><span>ä¸­è½¦é•¿æ˜¥è½¨é“å®¢è½¦</span><span class="bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">AAAçº§</span></li>
                            <li class="py-2 flex justify-between items-center"><span>å“ˆå°”æ»¨ç”µæ°”é›†å›¢</span><span class="bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">AAAçº§</span></li>
                            <li class="py-2 flex justify-between items-center"><span>ä¸­å›½ä¸€é‡é›†å›¢</span><span class="bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs">AA+çº§</span></li>
                            <li class="py-2 flex justify-between items-center"><span>æ²ˆé˜³æ–°æ¾æœºå™¨äºº</span><span class="bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs">AA+çº§</span></li>
                        </ul>
                    </div>
                </div>
                ${generateStandardTable('list', true)}
            `;
        }

        function generateValueMatrixDetail() {
            return `
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="bg-green-50 p-4 rounded border border-green-200">
                        <h4 class="font-bold text-green-800 mb-2">ğŸ’ é«˜ä»·å€¼/é«˜å¢é•¿ (æ˜æ˜Ÿä¸šåŠ¡)</h4>
                        <ul class="text-sm list-disc pl-4 text-green-700">
                            <li>æ–°èƒ½æºæ±½è½¦é›¶éƒ¨ä»¶ (é•¿æ˜¥/æ²ˆé˜³)</li>
                            <li>å·¥ä¸šæœºå™¨äººä¸è‡ªåŠ¨åŒ– (æ²ˆé˜³)</li>
                            <li>é«˜ç«¯åŒ»ç–—å½±åƒè®¾å¤‡ (å¤§è¿)</li>
                        </ul>
                    </div>
                    <div class="bg-yellow-50 p-4 rounded border border-yellow-200">
                        <h4 class="font-bold text-yellow-800 mb-2">ğŸ’° é«˜ä»·å€¼/ä½å¢é•¿ (ç°é‡‘ç‰›)</h4>
                        <ul class="text-sm list-disc pl-4 text-yellow-700">
                            <li>çŸ³æ²¹åŒ–å·¥è£…å¤‡ (æŠšé¡º/å¤§åº†)</li>
                            <li>é‡å‹çŸ¿å±±æœºæ¢° (éå±±)</li>
                            <li>ç»¿è‰²æœ‰æœºå†œäº§å“ (é»‘é¾™æ±Ÿå…¨åŸŸ)</li>
                        </ul>
                    </div>
                </div>
                <div class="bg-white rounded border border-slate-200 overflow-hidden">
                    <div class="px-4 py-2 bg-slate-50 font-bold text-sm text-slate-600 border-b border-slate-200">ä¼ä¸šä»·å€¼è¯„ä¼°æ˜ç»†</div>
                    <table class="min-w-full divide-y divide-slate-200 text-sm">
                        <thead class="bg-slate-50"><tr><th class="p-3 text-left">ä¼ä¸šåç§°</th><th class="p-3">äº§å€¼è§„æ¨¡</th><th class="p-3">å¹´å®¡é€šè¿‡ç‡</th><th class="p-3">è¯ä¹¦å¢é•¿</th><th class="p-3">è¯„çº§</th></tr></thead>
                        <tbody class="bg-white divide-y divide-slate-100">
                            <tr><td class="p-3">ä¸€æ±½-å¤§ä¼—æ±½è½¦æœ‰é™å…¬å¸</td><td class="p-3">500äº¿+</td><td class="p-3">100%</td><td class="p-3 text-green-600">+12%</td><td class="p-3"><span class="bg-blue-100 text-blue-800 px-2 rounded text-xs">Sçº§</span></td></tr>
                            <tr><td class="p-3">æ’åŠ›çŸ³åŒ–(å¤§è¿)æœ‰é™å…¬å¸</td><td class="p-3">200äº¿+</td><td class="p-3">98%</td><td class="p-3 text-slate-400">0%</td><td class="p-3"><span class="bg-blue-100 text-blue-800 px-2 rounded text-xs">Açº§</span></td></tr>
                            <tr><td class="p-3">é•¿å…‰å«æ˜ŸæŠ€æœ¯æœ‰é™å…¬å¸</td><td class="p-3">15äº¿</td><td class="p-3">100%</td><td class="p-3 text-green-600">+45%</td><td class="p-3"><span class="bg-green-100 text-green-800 px-2 rounded text-xs">S+çº§</span></td></tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function generateEfficiencyTable() {
            const data = [
                { lab: "CQCæ²ˆé˜³åˆ†ä¸­å¿ƒå®éªŒå®¤", cat: "ä½å‹ç”µå™¨", cycle: "12å¤©", avg: "15å¤©", pass: "98%", status: "ä¼˜" },
                { lab: "é•¿æ˜¥æ±½è½¦æ£€æµ‹ä¸­å¿ƒ", cat: "æ±½è½¦é›¶éƒ¨ä»¶", cycle: "25å¤©", avg: "28å¤©", pass: "92%", status: "è‰¯" },
                { lab: "å“ˆå°”æ»¨ç”µå·¥ä»ªè¡¨æ‰€", cat: "ä»ªå™¨ä»ªè¡¨", cycle: "15å¤©", avg: "20å¤©", pass: "95%", status: "ä¼˜" },
                { lab: "è¾½å®å®‰å…¨ç§‘å­¦ç ”ç©¶é™¢", cat: "é˜²çˆ†ç”µæ°”", cycle: "30å¤©", avg: "30å¤©", pass: "85%", status: "ä¸­" }
            ];
            return `
                <div class="mb-4 text-sm text-slate-600 bg-blue-50 p-3 rounded border border-blue-100">
                    <i class="fa-solid fa-circle-info text-blue-500 mr-1"></i> æ•°æ®è¯´æ˜ï¼šæ£€æµ‹å‘¨æœŸå¯¹æ¯”è¡Œä¸šå¹³å‡æ°´å¹³ï¼Œé€šè¿‡ç‡åŸºäºè¿‘12ä¸ªæœˆé¦–æ£€æ•°æ®ã€‚
                </div>
                <table class="min-w-full divide-y divide-slate-200">
                    <thead class="bg-slate-50"><tr><th class="p-3 text-left text-xs font-bold text-slate-500">æ£€æµ‹æœºæ„</th><th class="p-3 text-left text-xs font-bold text-slate-500">ç±»åˆ«</th><th class="p-3 text-left text-xs font-bold text-slate-500">æœºæ„å‘¨æœŸ</th><th class="p-3 text-left text-xs font-bold text-slate-500">è¡Œä¸šå‡å€¼</th><th class="p-3 text-left text-xs font-bold text-slate-500">ä¸€æ¬¡é€šè¿‡ç‡</th><th class="p-3 text-left text-xs font-bold text-slate-500">æ•ˆç‡è¯„çº§</th></tr></thead>
                    <tbody class="bg-white divide-y divide-slate-200">
                        ${data.map(d => `
                            <tr class="hover:bg-slate-50">
                                <td class="p-3 text-sm font-medium text-slate-900">${d.lab}</td>
                                <td class="p-3 text-sm text-slate-500">${d.cat}</td>
                                <td class="p-3 text-sm font-bold text-slate-700">${d.cycle}</td>
                                <td class="p-3 text-sm text-slate-400">${d.avg}</td>
                                <td class="p-3 text-sm text-blue-600 font-bold">${d.pass}</td>
                                <td class="p-3"><span class="px-2 py-1 rounded text-xs ${d.status==='ä¼˜'?'bg-green-100 text-green-700':d.status==='è‰¯'?'bg-blue-100 text-blue-700':'bg-yellow-100 text-yellow-700'}">${d.status}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function generateTrendDetail() {
            return `
                <div class="h-64 bg-white border border-slate-200 rounded p-4 mb-4">
                    <p class="text-xs text-slate-400 text-center">[æ­¤å¤„ä¸ºç»†åˆ†æœˆåº¦è¶‹åŠ¿å›¾çš„å¤§å›¾å±•ç¤ºåŒº]</p>
                    <canvas id="drillTrendChart"></canvas>
                </div>
                <table class="min-w-full divide-y divide-slate-200">
                    <thead class="bg-slate-50"><tr><th class="p-3 text-left text-xs font-bold text-slate-500">æœˆä»½</th><th class="p-3 text-left text-xs font-bold text-slate-500">æ–°å¢å‘è¯</th><th class="p-3 text-left text-xs font-bold text-slate-500">æš‚åœ/æ’¤é”€</th><th class="p-3 text-left text-xs font-bold text-slate-500">å‡€å¢é•¿</th><th class="p-3 text-left text-xs font-bold text-slate-500">ç¯æ¯”å˜åŒ–</th></tr></thead>
                    <tbody class="bg-white divide-y divide-slate-200">
                        <tr><td class="p-3 text-sm text-slate-900">2025-12</td><td class="p-3 text-sm text-green-600">+300</td><td class="p-3 text-sm text-red-500">-12</td><td class="p-3 text-sm font-bold text-slate-700">288</td><td class="p-3 text-sm text-green-600"><i class="fa-solid fa-arrow-up"></i> 5.2%</td></tr>
                        <tr><td class="p-3 text-sm text-slate-900">2025-11</td><td class="p-3 text-sm text-green-600">+270</td><td class="p-3 text-sm text-red-500">-15</td><td class="p-3 text-sm font-bold text-slate-700">255</td><td class="p-3 text-sm text-green-600"><i class="fa-solid fa-arrow-up"></i> 2.1%</td></tr>
                        <tr><td class="p-3 text-sm text-slate-900">2025-10</td><td class="p-3 text-sm text-green-600">+250</td><td class="p-3 text-sm text-red-500">-8</td><td class="p-3 text-sm font-bold text-slate-700">242</td><td class="p-3 text-sm text-slate-400">-</td></tr>
                    </tbody>
                </table>
            `;
        }

        function generateChurnDetail() {
            return `
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="p-4 border rounded bg-red-50 border-red-100">
                        <div class="text-sm font-bold text-red-700 mb-1">æœ¬æœˆæµå¤± (æ’¤é”€/æ³¨é”€)</div>
                        <div class="text-2xl font-bold text-red-600">32 <span class="text-xs font-normal text-red-400">å®¶ä¼ä¸š</span></div>
                    </div>
                    <div class="p-4 border rounded bg-orange-50 border-orange-100">
                        <div class="text-sm font-bold text-orange-700 mb-1">æœ¬æœˆæš‚åœ (å¯æ¢å¤)</div>
                        <div class="text-2xl font-bold text-orange-600">45 <span class="text-xs font-normal text-orange-400">å®¶ä¼ä¸š</span></div>
                    </div>
                </div>
                <div class="bg-white border border-slate-200 rounded overflow-hidden">
                    <div class="px-4 py-2 bg-slate-50 text-sm font-bold text-slate-600 border-b border-slate-200">é‡ç‚¹å…³æ³¨æµå¤±ä¼ä¸šæ¸…å•</div>
                    <table class="min-w-full divide-y divide-slate-200 text-sm">
                        <thead class="bg-white"><tr><th class="p-3 text-left">ä¼ä¸šåç§°</th><th class="p-3">è¡Œä¸š</th><th class="p-3">çŠ¶æ€å˜åŠ¨</th><th class="p-3">åŸå› </th><th class="p-3">å¤„ç†æ—¥æœŸ</th></tr></thead>
                        <tbody class="divide-y divide-slate-100">
                            <tr><td class="p-3 text-slate-900">æŠšé¡ºçŸ³åŒ–å·¥ç¨‹å»ºè®¾æœ‰é™å…¬å¸</td><td class="p-3 text-slate-500">åŒ–å·¥</td><td class="p-3"><span class="bg-red-100 text-red-800 px-2 py-0.5 rounded text-xs">æ’¤é”€</span></td><td class="p-3 text-slate-500">ä¸¥é‡è¿è§„/è™šå‡ææ–™</td><td class="p-3 text-slate-500">2025-12-10</td></tr>
                            <tr><td class="p-3 text-slate-900">å“ˆå°”æ»¨ä½³æœ¨æ–¯ç”µæœºå‚</td><td class="p-3 text-slate-500">ç”µå­</td><td class="p-3"><span class="bg-orange-100 text-orange-800 px-2 py-0.5 rounded text-xs">æš‚åœ</span></td><td class="p-3 text-slate-500">ç›‘ç£æŠ½æŸ¥ä¸åˆæ ¼</td><td class="p-3 text-slate-500">2025-12-05</td></tr>
                            <tr><td class="p-3 text-slate-900">è¾½å®å¤©ä¸€æœºæ¢°æœ‰é™å…¬å¸</td><td class="p-3 text-slate-500">è£…å¤‡</td><td class="p-3"><span class="bg-orange-100 text-orange-800 px-2 py-0.5 rounded text-xs">æš‚åœ</span></td><td class="p-3 text-slate-500">æœªæŒ‰æœŸç”³è¯·å¹´å®¡</td><td class="p-3 text-slate-500">2025-11-28</td></tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function generateGreenDetail() {
            return `
                <div class="p-4 bg-emerald-50 rounded border border-emerald-100 mb-4 flex items-center justify-between">
                    <div>
                        <h4 class="font-bold text-emerald-800">åŒç¢³æ”¿ç­–å“åº”è¿›åº¦</h4>
                        <p class="text-xs text-emerald-600 mt-1">ä¸œåŒ—åŒºåŸŸç»¿è‰²è®¤è¯ä¼ä¸šå æ¯”å·²è¾¾ 18.5%ï¼ŒåŒæ¯”æå‡ 3.2%</p>
                    </div>
                    <div class="text-3xl font-bold text-emerald-600">18.5%</div>
                </div>
                ${generateStandardTable('green_list', true)}
            `;
        }

        function generateAgeDetail() {
            return `
                <div class="grid grid-cols-4 gap-4 mb-4 text-center">
                    <div class="p-3 border rounded bg-slate-50"><div class="text-xs text-slate-500">æ–°å®¢æˆ· (<1å¹´)</div><div class="font-bold text-blue-600">15%</div></div>
                    <div class="p-3 border rounded bg-slate-50"><div class="text-xs text-slate-500">æˆé•¿æœŸ (1-3å¹´)</div><div class="font-bold text-blue-600">35%</div></div>
                    <div class="p-3 border rounded bg-slate-50"><div class="text-xs text-slate-500">æˆç†ŸæœŸ (3-5å¹´)</div><div class="font-bold text-blue-600">30%</div></div>
                    <div class="p-3 border rounded bg-blue-50 border-blue-200"><div class="text-xs text-blue-800">å¿ è¯šå®¢æˆ· (>5å¹´)</div><div class="font-bold text-blue-800">20%</div></div>
                </div>
                <div class="bg-white border border-slate-200 rounded overflow-hidden">
                    <div class="px-4 py-2 bg-slate-50 text-sm font-bold text-slate-600">å³å°†æµå¤±é¢„è­¦ (æœªç»­è¯ > 60å¤©)</div>
                    <table class="min-w-full divide-y divide-slate-200 text-sm">
                        <thead class="bg-white"><tr><th class="p-3 text-left">ä¼ä¸šåç§°</th><th class="p-3">æŒè¯å¹´é™</th><th class="p-3">é¢„è­¦ç­‰çº§</th><th class="p-3">æœ€åè”ç»œ</th></tr></thead>
                        <tbody class="divide-y divide-slate-100">
                            <tr><td class="p-3">å¤§è¿XXé£Ÿå“å‚</td><td class="p-3">4å¹´</td><td class="p-3 text-red-500 font-bold">é«˜</td><td class="p-3 text-slate-500">2025-10-01</td></tr>
                            <tr><td class="p-3">å‰æ—XXå»ºæå…¬å¸</td><td class="p-3">2å¹´</td><td class="p-3 text-orange-500 font-bold">ä¸­</td><td class="p-3 text-slate-500">2025-11-15</td></tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function generateComplianceDetail() {
            return `
                <div class="flex gap-4 mb-4">
                    <div class="flex-1 bg-white border border-slate-200 rounded p-4">
                        <h4 class="font-bold text-sm text-slate-700">ç›‘ç£æŠ½æŸ¥åˆæ ¼ç‡</h4>
                        <div class="mt-2 w-full bg-slate-100 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width: 92%"></div></div>
                        <div class="mt-1 text-right text-xs text-green-600 font-bold">92%</div>
                    </div>
                    <div class="flex-1 bg-white border border-slate-200 rounded p-4">
                        <h4 class="font-bold text-sm text-slate-700">å·¥å‚æ£€æŸ¥é€šè¿‡ç‡</h4>
                        <div class="mt-2 w-full bg-slate-100 rounded-full h-2"><div class="bg-blue-500 h-2 rounded-full" style="width: 96%"></div></div>
                        <div class="mt-1 text-right text-xs text-blue-600 font-bold">96%</div>
                    </div>
                </div>
                ${generateStandardTable('risk_list', true)}
            `;
        }

        function generateWordCloudDetail() {
            return `
                <div class="p-4 mb-4 bg-slate-50 border border-slate-200 rounded">
                    <h3 class="font-bold text-slate-800 mb-2">çƒ­è¯é€è§†: <span class="text-blue-600">æ–°èƒ½æºæ±½è½¦</span></h3>
                    <p class="text-sm text-slate-600">å…³è”ä¼ä¸šæ•°: <span class="font-bold">850</span> å®¶ | å…³è”è¯ä¹¦: <span class="font-bold">2,100</span> å¼  | å¢é•¿ç‡: <span class="text-green-600">+45%</span></p>
                </div>
                <div class="bg-white border border-slate-200 rounded overflow-hidden">
                    <div class="px-4 py-2 bg-slate-50 text-sm font-bold text-slate-600">å…³è”å¤´éƒ¨ä¼ä¸š</div>
                    <table class="min-w-full divide-y divide-slate-200 text-sm">
                        <thead class="bg-white"><tr><th class="p-3 text-left">ä¼ä¸šåç§°</th><th class="p-3">åŸå¸‚</th><th class="p-3">æ ¸å¿ƒäº§å“</th><th class="p-3">è®¤è¯æ ‡å‡†</th></tr></thead>
                        <tbody class="divide-y divide-slate-100">
                            <tr><td class="p-3">ä¸€æ±½-å¤§ä¼—æ±½è½¦æœ‰é™å…¬å¸</td><td class="p-3">é•¿æ˜¥</td><td class="p-3">ID.4 CROZZ</td><td class="p-3 font-mono text-slate-500">GB 18384-2020</td></tr>
                            <tr><td class="p-3">åæ™¨å®é©¬æ±½è½¦æœ‰é™å…¬å¸</td><td class="p-3">æ²ˆé˜³</td><td class="p-3">iX3</td><td class="p-3 font-mono text-slate-500">GB 38031-2020</td></tr>
                            <tr><td class="p-3">çº¢æ——æ–°èƒ½æºå·¥å‚</td><td class="p-3">é•¿æ˜¥</td><td class="p-3">E-HS9</td><td class="p-3 font-mono text-slate-500">GB/T 31498</td></tr>
                            <tr><td class="p-3">äº¿çº¬é”‚èƒ½(æ²ˆé˜³)å‚¨èƒ½å…¬å¸</td><td class="p-3">æ²ˆé˜³</td><td class="p-3">åŠ¨åŠ›ç”µæ± åŒ…</td><td class="p-3 font-mono text-slate-500">UN 38.3</td></tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function generateStandardTable(type, embedded = false) {
            let data = [
                { name: "ä¸€æ±½-å¤§ä¼—æ±½è½¦æœ‰é™å…¬å¸", city: "é•¿æ˜¥", industry: "æ±½è½¦", cert: "CCC-2024-8821", status: "æœ‰æ•ˆ", note: "å¹´åº¦å®¡æ ¸é€šè¿‡" },
                { name: "æ²ˆé˜³é¼“é£æœºé›†å›¢æ ¸ç”µæ³µä¸š", city: "æ²ˆé˜³", industry: "è£…å¤‡", cert: "CQC-2023-0012", status: "æœ‰æ•ˆ", note: "æ–°å¢æ ¸çº§è®¤è¯" },
                { name: "å“ˆè¯é›†å›¢åˆ¶è¯å…­å‚", city: "å“ˆå°”æ»¨", industry: "åŒ»è¯", cert: "GMP-2022-1102", status: "æœ‰æ•ˆ", note: "-" },
                { name: "éé’¢é›†å›¢å·¥ç¨‹æŠ€æœ¯æœ‰é™å…¬å¸", city: "éå±±", industry: "è£…å¤‡", cert: "ISO-2021-9921", status: "å³å°†è¿‡æœŸ", note: "éœ€åœ¨30å¤©å†…å¤è¯„" },
                { name: "å¤§è¿é‡å·¥Â·èµ·é‡é›†å›¢", city: "å¤§è¿", industry: "è£…å¤‡", cert: "CQC-2023-4412", status: "æœ‰æ•ˆ", note: "-" },
                { name: "å‰æ—åŒ–çº¤é›†å›¢", city: "å‰æ—", industry: "åŒ–å·¥", cert: "ISO-2024-1123", status: "æœ‰æ•ˆ", note: "ç»¿è‰²å·¥å‚ç¤ºèŒƒ" },
                { name: "é”¦å·ä¸‡å¾—æ±½è½¦é›†å›¢", city: "é”¦å·", industry: "æ±½è½¦", cert: "IATF-2023-0021", status: "æœ‰æ•ˆ", note: "-" },
                { name: "å“ˆå°”æ»¨ç”µæ°”é›†å›¢ä½³æœ¨æ–¯ç”µæœº", city: "ä½³æœ¨æ–¯", industry: "ç”µå­", cert: "CCC-2022-3312", status: "æš‚åœ", note: "ç›‘ç£æŠ½æŸ¥ä¸åˆæ ¼" },
                { name: "åŒ—å¤§è’å†œå¦é›†å›¢", city: "å“ˆå°”æ»¨", industry: "å†œé£Ÿ", cert: "ORG-2024-5512", status: "æœ‰æ•ˆ", note: "æœ‰æœºäº§å“ç»­æœŸ" },
                { name: "æ²ˆé˜³æ–°æ¾æœºå™¨äººè‡ªåŠ¨åŒ–", city: "æ²ˆé˜³", industry: "ç”µå­", cert: "CR-2023-7721", status: "æœ‰æ•ˆ", note: "æœºå™¨äººCRè®¤è¯" },
                { name: "æŠšé¡ºçŸ³åŒ–å·¥ç¨‹å»ºè®¾", city: "æŠšé¡º", industry: "åŒ–å·¥", cert: "ISO-2021-4412", status: "æ’¤é”€", note: "ä¸¥é‡è¿è§„" },
                { name: "é•¿æ˜¥è½¨é“å®¢è½¦è‚¡ä»½", city: "é•¿æ˜¥", industry: "è£…å¤‡", cert: "IRIS-2024-1100", status: "æœ‰æ•ˆ", note: "é«˜é“æ ‡å‡†" },
                { name: "åæ™¨å®é©¬æ±½è½¦æœ‰é™å…¬å¸", city: "æ²ˆé˜³", industry: "æ±½è½¦", cert: "CCC-2024-5566", status: "æœ‰æ•ˆ", note: "æ–°è½¦å‹å‡†å…¥" },
                { name: "å¤§åº†æ²¹ç”°è£…å¤‡åˆ¶é€ ", city: "å¤§åº†", industry: "è£…å¤‡", cert: "API-2023-8899", status: "æœ‰æ•ˆ", note: "-" }
            ];

            if (type.includes('risk') || type.includes('churn') || type.includes('compliance')) {
                data = data.filter(d => d.status !== 'æœ‰æ•ˆ' || d.note.includes('è¿‡æœŸ'));
            } else if (type.includes('green')) {
                data = data.filter(d => d.industry === 'åŒ–å·¥' || d.industry === 'å†œé£Ÿ');
            } else if (type.includes('heatmap_list') || type.includes('province_list')) {
                data = data.sort(() => 0.5 - Math.random());
            }

            const rows = data.map(item => {
                let statusClass = 'bg-green-100 text-green-800';
                if (item.status.includes('æš‚åœ')) statusClass = 'bg-orange-100 text-orange-800';
                if (item.status.includes('æ’¤é”€') || item.status.includes('è¿‡æœŸ')) statusClass = 'bg-red-100 text-red-800';

                return `
                <tr class="hover:bg-slate-50 transition-colors border-b border-slate-100">
                    <td class="whitespace-nowrap py-3 pl-4 pr-3 text-sm font-medium text-slate-900">${item.name}</td>
                    <td class="whitespace-nowrap px-3 py-3 text-sm text-slate-500">${item.city}</td>
                    <td class="whitespace-nowrap px-3 py-3 text-sm text-slate-500">${item.industry}</td>
                    <td class="whitespace-nowrap px-3 py-3 text-sm text-slate-500 font-mono">${item.cert}</td>
                    <td class="whitespace-nowrap px-3 py-3 text-sm"><span class="inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${statusClass}">${item.status}</span></td>
                    <td class="whitespace-nowrap px-3 py-3 text-sm text-slate-500">${item.note}</td>
                    <td class="whitespace-nowrap px-3 py-3 text-sm text-blue-600 cursor-pointer hover:underline">æŸ¥çœ‹</td>
                </tr>`;
            }).join('');

            return `
                <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg ${embedded ? '' : 'mt-2'}">
                    <table class="min-w-full divide-y divide-slate-300">
                        <thead class="bg-slate-50">
                            <tr>
                                <th class="py-3.5 pl-4 pr-3 text-left text-xs font-bold uppercase text-slate-500">ä¼ä¸šåç§°</th>
                                <th class="px-3 py-3.5 text-left text-xs font-bold uppercase text-slate-500">åŸå¸‚</th>
                                <th class="px-3 py-3.5 text-left text-xs font-bold uppercase text-slate-500">è¡Œä¸š</th>
                                <th class="px-3 py-3.5 text-left text-xs font-bold uppercase text-slate-500">è¯ä¹¦ç¼–å·</th>
                                <th class="px-3 py-3.5 text-left text-xs font-bold uppercase text-slate-500">çŠ¶æ€</th>
                                <th class="px-3 py-3.5 text-left text-xs font-bold uppercase text-slate-500">å¤‡æ³¨/é£é™©é¡¹</th>
                                <th class="px-3 py-3.5 text-left text-xs font-bold uppercase text-slate-500">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200 bg-white">${rows}</tbody>
                    </table>
                </div>
                ${embedded ? '' : `<div class="mt-4 flex justify-between items-center"><span class="text-sm text-slate-500">å…± ${data.length} æ¡æ•°æ®</span><div class="flex gap-1"><button class="px-3 py-1 border rounded text-sm text-slate-600">ä¸Šä¸€é¡µ</button><button class="px-3 py-1 border rounded text-sm text-white bg-blue-600">1</button><button class="px-3 py-1 border rounded text-sm text-slate-600">ä¸‹ä¸€é¡µ</button></div></div>`}
            `;
        }

        function closeModal() {
            document.getElementById('commonModal').classList.add('hidden');
        }

        // --- 4. Scroll Spy ---
        const sections = document.querySelectorAll('section[id]');
        const navLinks = document.querySelectorAll('.anchor-link');
        const scrollContainer = document.getElementById('scroll-container');

        scrollContainer.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                if (scrollContainer.scrollTop >= (section.offsetTop - 200)) {
                    current = section.getAttribute('id');
                }
            });
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').includes(current)) link.classList.add('active');
            });
        });

    </script>
</body>
</html>
